machine:
  ruby:
    version: 2.3.1

dependencies:
  override:
    - gem install jekyll
    - jekyll --version

test:
  override:
    - echo skip

deployment:
  automerge:
    branch: develop
    commands:
      - jekyll build
      - git checkout master
      - git merge develop
      - git push

  autopublish:
    branch: master
    commands:
      - jekyll build
      - mv circle.yml .git/ _site/
      - cd _site; git config --global user.email "circleci@nickbreaton.com"
      - cd _site; git config --global user.name "CircleCI"
      - cd _site; git checkout --orphan gh-pages
      - cd _site; git add -A
      - cd _site; git commit -m "Publish to gh-pages"
      - cd _site; git push --force
